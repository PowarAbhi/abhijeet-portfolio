<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Abhijeet Powar – Portfolio</title>
  <meta name="description" content="Portfolio of Abhijeet Powar – Graphic Designer, Video Editor & AI Creative." />
  <!-- Updated Google Fonts: Kufam for body, DM Sans for headings, and Gochi Hand for decorative text -->
  <link href="https://fonts.googleapis.com/css2?family=Kufam:wght@400;500;600;700&family=DM+Sans:wght@700;800;900&family=Gochi+Hand&display=swap" rel="stylesheet">
  <style>
    /* Exact Color Palette from Screenshot */
    :root {
      --bg: #FFFBF0; /* Very light creamy yellow background */
      --panel: #FFFFFF; /* Pure white for nav and card backgrounds */
      --muted: #7A7A7A; /* Medium grey for secondary text */
      --text: #333333; /* Dark grey for primary text and borders */
      --brand: #FFD700; /* Vibrant yellow for main highlights (like the 'I'm Done!' button) */
      --accent: #80DEEA; /* Light blue for secondary accents */
      --secondary-red: #FF6666; /* Red accent color from shapes */
      --secondary-green: #66BB6A; /* Green accent color from shapes */
      --card-bg: var(--panel); /* Cards are pure white */
      --border-color: var(--text); /* Dark grey for all borders */
      --shadow-color: rgba(51, 51, 51, 0.2); /* Dark grey shadow */
      --primary-font: 'Kufam', sans-serif; /* For general text */
      --heading-font: 'DM Sans', sans-serif; /* For big headings/titles */
      --decorative-font: 'Gochi Hand', cursive; /* For the brand name */
    }

    /* General styling */
    * {
      box-sizing: border-box;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: var(--primary-font); /* Apply Kufam as primary font */
      color: var(--text);
      background-color: var(--bg);
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
      position: relative;
    }

    /* Background doodle shapes and pen tool (more prominent and accurately placed) */
    body::before, body::after {
      content: '';
      position: absolute;
      z-index: -1;
      pointer-events: none;
      opacity: 1; /* Make shapes more visible */
    }

    body::before { /* Pen tool */
      top: 10%;
      left: 10%;
      width: 100px; /* Larger */
      height: 100px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23FFD700' d='M19.78 2.06a.75.75 0 0 0-1.06 0L4.31 16.47a.75.75 0 0 0 0 1.06l2.12 2.12a.75.75 0 0 0 1.06 0L21.78 3.12a.75.75 0 0 0 0-1.06l-2.12-2.12zM15.5 5L17 6.5L6.5 17L5 15.5z'/%3E%3C/svg%3E"); /* Yellow pen tool */
      background-size: contain;
      background-repeat: no-repeat;
      transform: rotate(-30deg);
      opacity: 0.6; /* More visible */
    }

    body::after { /* Shapes */
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 1000'%3E%3C!-- Circle --%3E%3Ccircle cx='120' cy='120' r='60' fill='%23FFD700' opacity='0.7'/%3E%3C!-- Rectangle --%3E%3Crect x='850' y='70' width='120' height='120' fill='%2380DEEA' opacity='0.7'/%3E%3C!-- Triangle --%3E%3Cpolygon points='180,850 300,950 60,950' fill='%23FF6666' opacity='0.7'/%3E%3C!-- Square 2 --%3E%3Crect x='300' y='500' width='80' height='80' fill='%2366BB6A' opacity='0.7'/%3E%3C!-- Plus Sign --%3E%3Cpath d='M700 300 H720 V280 H700 V260 H680 V280 H660 V300 H680 V320 H700 Z' fill='%23FFD700' opacity='0.7'/%3E%3C!-- Squiggly Line --%3E%3Cpath d='M50 400 Q150 350 250 400 T450 400' stroke='%23FF6666' stroke-width='10' fill='none' opacity='0.7'/%3E%3C!-- Dashed Line --%3E%3Cline x1='800' y1='700' x2='900' y2='600' stroke='%2380DEEA' stroke-width='8' stroke-dasharray='15 15' opacity='0.7'/%3E%3C/svg%3E");
      background-size: cover;
      background-repeat: no-repeat;
      opacity: 0.2; /* Overall opacity for the shape layer */
      transform: rotate(5deg); /* Slight rotation for a playful feel */
    }

    a {
      color: var(--text);
      text-decoration: none;
    }

    /* ---------- PRELOADER ---------- */
    .preloader {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg, var(--bg), var(--panel));
      z-index: 9999;
      transition: opacity .45s ease, visibility .45s ease;
      opacity: 1;
      visibility: visible;
      flex-direction: column;
      gap: 18px;
    }
    .preloader.hide {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    .preloader__avatar {
      width: 140px;
      height: 140px;
      border-radius: 999px;
      overflow: hidden;
      display: grid;
      place-items: center;
      box-shadow: 0 10px 20px var(--shadow-color);
      border: 3px solid var(--border-color);
      transform: scale(1);
      animation: pulse 1500ms infinite ease-in-out;
      background: linear-gradient(135deg, var(--brand), var(--accent));
    }
    .preloader__avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .preloader__caption {
      color: var(--muted);
      font-weight: 600;
      font-size: 14px;
      opacity: .95;
    }
    @keyframes pulse {
      0% {
        transform: scale(0.98);
        filter: saturate(.98);
      }
      50% {
        transform: scale(1.04);
        filter: saturate(1.05);
      }
      100% {
        transform: scale(0.98);
        filter: saturate(.98);
      }
    }

    /* ---------- NAV & LAYOUT (doodle style) ---------- */
    .container {
      width: min(1100px, 94vw);
      margin-inline: auto;
    }
    .nav {
      position: sticky;
      top: 0;
      z-index: 60;
      background: var(--panel); /* Pure white */
      backdrop-filter: blur(6px);
      border: 2px solid var(--border-color); /* Exact border thickness */
      border-top: none; /* No top border */
      box-shadow: 0 4px 10px var(--shadow-color); /* Softer shadow */
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      padding: 5px 0;
    }
    .nav-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 0;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      color: var(--text);
      font-family: var(--decorative-font); /* Gochi Hand for brand name */
      font-size: 1.6em;
    }
    .badge {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      background: var(--brand);
      display: grid;
      place-items: center;
      font-weight: 800;
      color: var(--text);
      border: 2px solid var(--border-color);
      box-shadow: 0 3px 8px var(--shadow-color);
    }
    .links {
      display: flex;
      gap: 18px;
      align-items: center;
    }
    .links a {
      padding: 10px 15px;
      border-radius: 12px;
      font-weight: 700;
      color: var(--text);
      transition: all 0.2s ease;
      border: 2px solid transparent;
      position: relative;
    }
    .links a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      background-color: var(--brand);
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }
    .links a:hover::before {
      width: 80%;
    }
    .links a:hover {
      background-color: var(--panel);
      color: var(--text);
      border-color: var(--accent);
      box-shadow: 0 2px 5px var(--shadow-color);
    }
    .nav-toggle {
      display: none;
      background: transparent;
      border: 0;
      color: var(--text);
      font-size: 32px;
      padding: 8px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .nav-toggle:hover {
      background-color: var(--panel);
      box-shadow: 0 2px 5px var(--shadow-color);
    }

    .hero {
      padding: 80px 0;
    }
    .hero-grid {
      display: grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 40px;
      align-items: center;
    }
    .kicker {
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .3em;
      text-transform: uppercase;
      font-size: 14px;
    }
    .title {
      font-family: var(--heading-font); /* DM Sans for title */
      font-size: clamp(38px, 6vw, 64px);
      line-height: 1.1;
      margin: 15px 0 20px;
      font-weight: 900;
      color: var(--text);
    }
    .title b {
      background: linear-gradient(135deg, var(--brand), var(--accent));
      -webkit-background-clip: text;
      color: transparent;
    }
    .lead {
      color: var(--muted);
      font-size: clamp(17px, 2.2vw, 20px);
      line-height: 1.7;
    }
    .cta {
      display: flex;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      padding: 14px 28px;
      border-radius: 18px;
      background: var(--brand); /* Solid yellow background */
      border: 2px solid var(--border-color);
      font-weight: 800;
      color: var(--text);
      box-shadow: 0 4px 10px var(--shadow-color); /* Matches screenshot shadow depth */
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 6px 15px var(--shadow-color);
      background: var(--accent); /* Light blue on hover */
    }
    .ghost {
      background: var(--panel); /* White background for ghost buttons */
      border: 2px solid var(--border-color);
      color: var(--text);
      box-shadow: 0 4px 10px var(--shadow-color); /* Matches screenshot shadow depth */
    }
    .ghost:hover {
      background-color: var(--accent);
      color: var(--text);
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 6px 15px var(--shadow-color);
    }

    .card {
      border-radius: 20px;
      padding: 20px;
      background: var(--panel);
      border: 2px solid var(--border-color);
      box-shadow: 0 8px 20px var(--shadow-color); /* Matches screenshot shadow depth */
    }
    .thumb {
      border-radius: 15px;
      overflow: hidden;
      background: var(--panel);
      display: block;
      border: 2px solid var(--border-color);
    }
    .thumb img {
      display: block;
      width: 100%;
      height: auto;
      object-fit: cover;
    }

    section {
      padding: 80px 0;
    }
    .section-title {
      font-family: var(--heading-font); /* DM Sans for section titles */
      font-size: clamp(32px, 4vw, 48px);
      margin: 0 0 15px;
      font-weight: 900;
      color: var(--brand);
    }
    .muted {
      color: var(--muted);
    }
    .grid {
      display: grid;
      gap: 25px;
    }
    .grid.cols-3 {
      grid-template-columns: repeat(3, 1fr);
    }
    .grid.cols-2 {
      grid-template-columns: repeat(2, 1fr);
    }
    .resume-item {
      padding: 25px;
      border-radius: 20px;
      background: var(--panel);
      border: 2px solid var(--border-color);
      box-shadow: 0 4px 10px var(--shadow-color); /* Matches screenshot shadow depth */
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .resume-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px var(--shadow-color);
    }
    .resume-item h4 {
      margin-top: 0;
      margin-bottom: 10px;
      color: var(--text);
      font-size: 1.3em;
    }
    .resume-item small {
      font-size: 0.9em;
      display: block;
      margin-bottom: 8px;
    }
    .resume-item p {
      font-size: 1em;
      line-height: 1.6;
    }
    .pill {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 999px;
      background: var(--accent);
      color: var(--text);
      font-weight: 700;
      font-size: 14px;
      border: 2px solid var(--border-color);
      box-shadow: 0 2px 5px var(--shadow-color); /* Matches screenshot shadow depth */
    }

    .filters {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin: 20px 0 30px;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border-radius: 999px;
      background: var(--panel);
      border: 2px solid var(--border-color);
      color: var(--text);
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0 3px 8px var(--shadow-color); /* Matches screenshot shadow depth */
    }
    .chip:hover {
      background-color: var(--accent);
      color: var(--text);
      border-color: var(--brand);
      transform: translateY(-2px);
      box-shadow: 0 5px 12px var(--shadow-color);
    }
    .chip[aria-pressed="true"] {
      background: var(--brand);
      color: var(--text);
      border-color: var(--border-color);
      box-shadow: 0 4px 10px var(--shadow-color); /* Matches screenshot shadow depth */
      transform: translateY(-1px);
    }

    /* Pinterest-style masonry layout for all screen sizes */
    .masonry {
      display: grid;
      grid-gap: 25px;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    }

    .masonry-item {
      break-inside: avoid;
      width: 100%;
      margin: 0;
    }
    .work-card {
      display: block;
      border-radius: 20px;
      overflow: hidden;
      border: 2px solid var(--border-color);
      background: var(--panel);
      box-shadow: 0 8px 20px var(--shadow-color); /* Matches screenshot shadow depth */
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      height: 100%;
    }
    .work-card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 10px 25px var(--shadow-color);
    }
    .work-img {
      width: 100%;
      display: block;
      height: auto;
      object-fit: cover;
      border-bottom: 1px solid var(--border-color);
    }
    .work-caption {
      padding: 18px;
      color: var(--muted);
      font-size: 16px;
      font-weight: 500;
    }

    footer {
      padding: 50px 0;
      color: var(--muted);
      border-top: 2px solid var(--border-color);
      background-color: var(--panel);
      margin-top: 80px;
    }
    footer .section-title {
      color: var(--text);
      font-family: var(--heading-font); /* DM Sans for footer section title */
      font-size: clamp(28px, 3.5vw, 42px);
    }
    footer .card {
      background: var(--bg);
      box-shadow: 0 4px 10px var(--shadow-color); /* Matches screenshot shadow depth */
    }
    footer p.muted {
      text-align: center;
      margin-top: 25px;
      font-size: 1.1em;
    }


    /* Responsive adjustments */
    @media (max-width: 980px) {
      .hero-grid {
        grid-template-columns: 1fr;
        gap: 40px;
        padding: 0;
      }
      .nav-inner {
        padding: 10px 4vw;
      }
      .links {
        display: none;
      }
      .nav-toggle {
        display: inline-flex;
      }
      .container {
        width: 94vw;
      }
      .grid.cols-3, .grid.cols-2 {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      .section-title {
        font-size: clamp(30px, 4.5vw, 42px);
      }
      .title {
        font-size: clamp(36px, 7vw, 56px);
      }
      body::before { /* Adjust pen tool position for mobile */
        top: 5vh;
        left: 5vw;
        width: 60px;
        height: 60px;
      }
    }

    @media (max-width: 768px) {
      .masonry {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        grid-gap: 20px;
      }
      .hero {
        padding: 60px 0;
      }
      .cta .btn {
        padding: 12px 24px;
        font-size: 16px;
      }
      section {
        padding: 60px 0;
      }
      .pill {
        padding: 9px 16px;
        font-size: 13px;
      }
    }

    @media (max-width: 520px) {
      .hero {
        padding: 40px 0;
      }
      .title {
        font-size: 32px;
        margin-bottom: 15px;
      }
      .cta .btn {
        padding: 10px 18px;
        font-size: 15px;
      }
      .section-title {
        font-size: 28px;
      }
      .masonry {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        grid-gap: 15px;
      }
      .chip {
        padding: 10px 16px;
        font-size: 14px;
      }
      .mobile-menu {
        top: 70px;
        padding: 12px;
      }
    }
    .mobile-menu {
      display: none;
      position: absolute;
      inset-inline: 0;
      top: 64px;
      background: var(--panel); /* Pure white for mobile menu */
      padding: 15px;
      border-bottom: 2px solid var(--border-color);
      box-shadow: 0 5px 15px var(--shadow-color);
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
    }
    .mobile-menu a {
      display: block;
      padding: 12px 18px;
      border-radius: 15px;
      margin-bottom: 10px;
      transition: all 0.2s ease;
      color: var(--text);
      border: 1px solid transparent;
      font-weight: 600;
    }
    .mobile-menu a:hover {
      background-color: var(--accent);
      color: var(--text);
      border-color: var(--brand);
    }
    .mobile-menu.show {
      display: block;
    }

    html.loading {
      overflow: hidden;
    }
  </style>
</head>
<body id="top" class="loading">
  <!-- PRELOADER -->
  <div id="preloader" class="preloader" role="status" aria-live="polite" aria-label="Loading portfolio">
    <div class="preloader__avatar" aria-hidden="true">
      <!-- Replace with your instagram/profile image file (recommended: assets/uploads/profile.jpg) -->
      <img id="preloaderImg" src="assets/uploads/profile.jpg" alt="Abhijeet Powar">
    </div>
    <div class="preloader__caption">Abhijeet Powar — Loading…</div>
  </div>

  <!-- NAV -->
  <header class="nav" role="banner">
    <div class="container nav-inner">
      <a class="brand" href="#top" aria-label="Home">
        <span class="badge" aria-hidden="true">AP</span>
        <span style="font-weight:800">Abhijeet Powar</span>
      </a>

      <nav class="links" aria-label="Primary">
        <a href="#resume">Resume</a>
        <a href="#works">Works</a>
        <a href="#contact">Contact</a>
        <button id="themeToggleBtn" class="chip" title="Toggle theme" aria-pressed="false">Theme</button>
      </nav>

      <button id="navToggle" class="nav-toggle" aria-label="Open menu" aria-expanded="false">☰</button>
    </div>

    <div id="mobileMenu" class="mobile-menu" aria-hidden="true">
      <a href="#resume">Resume</a>
      <a href="#works">Works</a>
      <a href="#contact">Contact</a>
      <a href="mailto:abhipowar2400@gmail.com">Email</a>
    </div>
  </header>

  <!-- MAIN -->
  <main id="main">
    <!-- HERO -->
    <section class="hero">
      <div class="container hero-grid">
        <div>
          <div class="kicker">My Portfolio — Design</div>
          <h1 class="title">Hi, I'm <b>Abhijeet Powar</b> — Graphic Designer, Video Editor & <b>AI Creative</b>.</h1>
          <p class="lead">I craft visuals that captivate — vector art, logos, photo manipulation, posters, digital painting, motion graphics and video edits.</p>
          <div class="cta">
            <a class="btn" href="#resume">View Resume</a>
            <a class="btn ghost" href="#works">View Works</a>
          </div>
          <p class="muted" style="margin-top:18px">Based in Gadhinglaj, Maharashtra • Available for freelance & collaborations</p>
        </div>

        <aside class="card" aria-hidden="false">
          <div class="thumb">
            <img id="heroImage" src="assets/uploads/cover.jpg" alt="Portfolio cover">
          </div>
          <div style="margin-top:18px;display:flex;gap:12px;flex-wrap:wrap">
            <span class="pill">Illustrator</span>
            <span class="pill">Photoshop</span>
            <span class="pill">Video Editing</span>
            <span class="pill">AI Tools</span>
          </div>
        </aside>
      </div>
    </section>

    <!-- RESUME -->
    <section id="resume" class="container">
      <h2 class="section-title">Resume</h2>
      <p class="muted">A quick view of my background, experience and skills.</p>

      <div class="grid cols-2" style="margin-top:30px">
        <article class="resume-item">
          <h4>Senior Computer Trainer</h4>
          <small class="muted">Hitech Computer Education Institute • 2022–2025</small>
          <p>Trained students in CCC, Tally, Graphic Designing, Video Editing and more.</p>
        </article>

        <article class="resume-item">
          <h4>Marketing & Graphic Designer</h4>
          <small class="muted">Marketing Department • 2022–2025</small>
          <p>Designed posters, ads and digital graphics; managed social presence.</p>
        </article>
      </div>

      <div class="grid cols-3" style="margin-top:25px">
        <article class="resume-item"><h4>Education</h4><small class="muted">2022–2025</small><p>B.Com — Sadhana College of Commerce.</p></article>
        <article class="resume-item"><h4>Software Skills</h4><p>Illustrator, Photoshop, Premiere/After Effects, AI tools.</p></article>
        <article class="resume-item"><h4>Personal Skills</h4><p>Adaptable • Communication • Teamwork • Learning mindset</p></article>
      </div>
    </section>

    <!-- WORKS -->
    <section id="works" class="container">
      <h2 class="section-title">Works</h2>
      <p class="muted">One gallery for everything. Use the filters to view specific categories.</p>

      <div class="filters" role="toolbar" aria-label="Work Filters">
        <button class="chip" data-filter="All" aria-pressed="true">All</button>
        <button class="chip" data-filter="Illustrator">Illustrator</button>
        <button class="chip" data-filter="Photoshop">Photoshop</button>
        <button class="chip" data-filter="Video">Video</button>
        <button class="chip" data-filter="Blender">Blender</button>
      </div>

      <div id="masonry" class="masonry" aria-live="polite" tabindex="0" aria-label="Portfolio gallery"></div>
      <div id="emptyMsg" class="muted" style="display:none;margin-top:8px">No items match this filter yet.</div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer id="contact">
    <div class="container" style="padding:30px 0">
      <div style="display:flex;gap:25px;flex-wrap:wrap;align-items:center;justify-content:space-between">
        <div>
          <h3 class="section-title" style="margin-bottom:10px">Let's Connect</h3>
          <p class="muted">Ready to collaborate? Reach out for freelance or projects.</p>
          <div style="margin-top:18px;display:flex;gap:12px;flex-wrap:wrap">
            <a class="btn" href="mailto:abhipowar2400@gmail.com">Email</a>
            <a class="btn ghost" href="tel:+919422733472">+91-94227-33472</a>
            <a class="btn ghost" href="https://instagram.com/abhi._powar._" target="_blank" rel="noopener">Instagram</a>
          </div>
        </div>

        <div class="card" style="min-width:280px;padding:18px;border-radius:20px">
          <div style="display:flex;gap:12px;flex-wrap:wrap">
            <span class="pill">Gadhinglaj, Maharashtra</span>
            <span class="pill">IST (UTC+5:30)</span>
            <span class="pill">Remote / On-site</span>
          </div>
        </div>
      </div>

      <p class="muted" style="margin-top:25px;">© <span id="y"></span> Abhijeet Powar • Designed with ❤️</p>
    </div>
  </footer>

  <script>
    // footer year
    document.getElementById('y').textContent = new Date().getFullYear();

    // mobile nav toggle
    const navToggle = document.getElementById('navToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    navToggle.addEventListener('click', () => {
      const expanded = navToggle.getAttribute('aria-expanded') === 'true';
      navToggle.setAttribute('aria-expanded', String(!expanded));
      mobileMenu.classList.toggle('show');
      mobileMenu.setAttribute('aria-hidden', String(expanded));
    });

    // theme toggle (simple)
    const themeBtn = document.getElementById('themeToggleBtn');
    const root = document.documentElement;
    const saved = localStorage.getItem('theme');
    if (saved) root.setAttribute('data-theme', saved);
    themeBtn.addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'light' ? '' : 'light';
      if(next) root.setAttribute('data-theme', next); else root.removeAttribute('data-theme');
      localStorage.setItem('theme', next);
      themeBtn.setAttribute('aria-pressed', String(next === 'light'));
    });

    /* ---------- Preloader logic ---------- */
    (function() {
      const preloader = document.getElementById('preloader');
      const body = document.documentElement;
      let pageLoaded = false;
      let dataLoaded = false;
      let hidden = false;

      // safety timeout: remove preloader after 4s max
      const MAX_WAIT = 4000;
      const timer = setTimeout(() => {
        hidePreloader('timeout');
      }, MAX_WAIT);

      function tryHide() {
        // hide only after both are loaded OR timeout triggered
        if ((pageLoaded && dataLoaded) && !hidden) {
          hidePreloader('ok');
        }
      }

      function hidePreloader(reason) {
        if (hidden) return;
        hidden = true;
        clearTimeout(timer);
        preloader.classList.add('hide');
        // remove body lock
        body.classList.remove('loading');
        // slight delay so CSS transition can complete
        setTimeout(() => {
          preloader.style.display = 'none';
        }, 500);
        // console for debugging
        console.log('Preloader hidden:', reason);
      }

      // when window fully loaded (images, fonts, etc)
      window.addEventListener('load', () => {
        pageLoaded = true;
        tryHide();
      });

      // expose function for when your JSON gallery finishes rendering
      window.__worksDataReady = function() {
        dataLoaded = true;
        tryHide();
      };

      // fallback: if nothing happens, hide in MAX_WAIT
    })();


    /* ------- WORKS: load data/works.json and render masonry ------- */
    const state = { all: [], filter: 'All' };
    const masonry = document.getElementById('masonry');
    const emptyMsg = document.getElementById('emptyMsg');

    fetch('data/works.json', {cache: 'no-store'})
      .then(r => r.ok ? r.json() : Promise.reject('Missing data/works.json'))
      .then(json => {
        state.all = json.works || [];
        render();
        // signal preloader that data is ready
        if (window.__worksDataReady) window.__worksDataReady();
      })
      .catch(err => {
        masonry.innerHTML = `<div class="muted">${err}. Add data/works.json to the repo.</div>`;
        if (window.__worksDataReady) window.__worksDataReady();
      });

    function toCard(w){
      const alt = (w.alt || w.title || 'Portfolio image').replace(/"/g,'&quot;');
      const caption = w.title ? `<figcaption class="work-caption">${w.title}</figcaption>` : '';
      const img = `<img loading="lazy" class="work-img" src="${w.src}" alt="${alt}">`;
      const linkOpen = w.href ? `<a class="work-card" href="${w.href}" target="_blank" rel="noopener">` : `<figure class="work-card">`;
      const linkClose = w.href ? `</a>` : `</figure>`;
      return `<div class="masonry-item">${linkOpen}${img}${caption}${linkClose}</div>`;
    }

    function render(){
      const list = state.filter === 'All' ? state.all : state.all.filter(w => (w.tags || []).includes(state.filter));
      masonry.innerHTML = list.map(toCard).join('');
      emptyMsg.style.display = list.length ? 'none' : 'block';
    }

    // filter chips
    document.querySelector('.filters').addEventListener('click', (e) => {
      const btn = e.target.closest('[data-filter]');
      if(!btn) return;
      state.filter = btn.getAttribute('data-filter');
      for(const el of e.currentTarget.querySelectorAll('[data-filter]')){
        el.setAttribute('aria-pressed', el === btn ? 'true' : 'false');
      }
      render();
      // scroll into view so user sees results on mobile
      document.getElementById('masonry').scrollIntoView({behavior:'smooth', block:'start'});
    });

    // keyboard support for chips
    document.querySelectorAll('.chip').forEach(chip => {
      chip.tabIndex = 0;
      chip.addEventListener('keyup', (e) => { if(e.key === 'Enter' || e.key === ' ') chip.click(); });
    });

    // ensure preloader hides also if window already loaded (rare)
    if (document.readyState === 'complete') {
      // give a tick for event listeners to attach
      setTimeout(() => { window.dispatchEvent(new Event('load')); }, 50);
    }
  </script>
</body>
</html>
